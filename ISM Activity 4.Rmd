---
title: "ISM - Activity 4"
author: "Geraldo B. Padilla F."
date: "11/10/2021"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
 Intro
```{r, include=FALSE}
pack <- c("tidyverse", "mosaic", "ggformula", 'car')
lapply(pack, require, character.only = TRUE)
dat <- readr::read_csv("https://raw.githubusercontent.com/lebebr01/psqf_6243/main/data/pumpkins.csv")
theme_set(theme_bw(base_size = 18))
```

#Guiding Question

How much variation is explained in the pumpkin weight (weight_lbs) by the over the top pumpkin measurement (inches)?
After controlling for pumpkin over the top measurement, is there any differences between United States growers compared to growers from other countries?

Questions

1. Explore the research questions descriptively. What are key messages based on the descriptive analysis?

```{r}
gf_density(~ weight_lbs, data = dat) %>%
  gf_labs(x = 'Pumpkin weight (lbs)')
```

```{r}
gf_density(~ ott, data = dat) %>%
  gf_labs(x = "Over the top of the pumpkin measurement (inches)")
```

```{r}
gf_point(weight_lbs ~ ott, data = dat, size = 2, alpha = .2) %>%
  gf_smooth(method = 'loess', linetype = 2, color = 'red') %>%
  gf_smooth(method = 'lm', linetype = 2, color = 'lightblue') %>%
  gf_labs(x = 'Over the top of the pumpkin measurement (inches)',
          y = "Pumpkin weight (lbs)")
```

```{r}
dat <- dat %>%
  filter(ott > 0)
```

```{r}
gf_point(weight_lbs ~ ott, data = dat, size = 2, alpha = .2) %>%
  gf_smooth(method = 'loess', linetype = 2, color = 'red') %>%
  gf_smooth(method = 'lm', linetype = 2, color = 'lightblue') %>%
  gf_labs(x = 'Over the top of the pumpkin measurement (inches)',
          y = "Pumpkin weight (lbs)")
```


2. Fit a linear regression model to explore the first research question. Summarize the key messages/takeaways from the results of this regression model.

```{r}
m1 = lm(weight_lbs ~ ott, data = dat)
summary(m1)
```

```{r}
dat <- dat %>%
  mutate(ott_mean = ott - mean(ott))
m2 = lm(weight_lbs ~ ott_mean, data = dat)
summary(m2)
```

3. Fit a second linear regression model to explore the subquestion above. Summarize the key messages/takeaways from the results of this regression model.

```{r}
m4 = lm(weight_lbs ~ ott_mean + us_dummy, data = dat)
```







```{r}
dat <- dat %>%
  mutate(ott_quad = ott^2)
m3 = lm(weight_lbs ~ ott + ott_quad, data = dat)
summary(m3)
```


```{r}
broom::tidy(m3)
broom::glance(m3)
```

4. Fit the third linear regression model that includes an interaction between the two primary attributes of interest from the research questions.

```{r}
m5 = lm(weight_lbs ~ ott_mean * us_dummy, data = dat)
```


5. Finally, instead of comparing United States vs other countries, try a new series of models equivalent to #3 and #4 that break the United States by their region (ie, use us_region). a. Are all of these models nested? b. Perform the appropriate model comparison to identify the best fitting model.

6. Is the added complexity of splitting the United States into specific regions justified? Why or why not?


