---
title: "Design of experiments"
author: "Geraldo B. Padilla F."
date: "12-09-2021"
output: html_document
---

```{r}
rm(list = ls())    # Remove all objects (start with clean slate) 
opar = par()       # Save default graphics parameters as opar
setwd("/RCode")    # Set the working directory
getwd()            # Get/display name of working directory
options(show.signif.stars=FALSE) # Show no stars for significance tests
options(width=72, digits=5, scipen=2) # Control printed output 
ooptions = options(width=72, digits=5, scipen=2) # Save print options
```

Randomize.r, Section 3.9, pages 59-60

```{r}
trtmt = c(1,1,1,2,2,2)  # Create column trtmt = (1,1,1,2,2,2)
ranno = runif(length(trtmt))  # Create column of 6 unif(0,1) RVs
design = data.frame(trtmt,ranno)  # Create data.frame "design""
design  # Display the data.frame design
order(ranno)  # Display positions of ordered RVs, for illustration only
design = design[order(ranno),]  # Sort rows by RVs, save
design  # Display design with rows sorted, for illustration only
design$EU = c(1:6)  # Add col EU = (1,2,3,4,5,6) to design
design  # Display the results of the randomization
```

Soap experiment, Tables 3.10 and 3.11, pages 60 and 63
```{r}
Soap <- c(1,1,1,1,2,2,2,2,3,3,3,3)
Cube <- c(1,2,3,4,5,6,7,8,9,10,11,12)
Prewt <- c(13.14, 13.17, 13.17, 13.17, 13.03, 13.18, 13.12, 13.19, 13.14, 13.19, 13.06, 13.00)
Postwt <- c(13.44, 13.27, 13.31, 12.77, 10.40, 10.57, 10.71, 10.04, 11.28, 11.16, 10.80, 11.18)
WtLoss <- c(-0.30, -0.10, -0.14, 0.40, 2.63, 2.61, 2.41, 3.15, 1.86, 2.03, 2.26, 1.82)
soap.data <- data.frame(Soap, Cube, Prewt, Postwt, WtLoss)
```


# Table 3.10, p60
# Read the data into the data.frame "soap.data"

```{r}
soap.data = read.table("C:/Users/Lenovo/OneDrive - University of Iowa/PhD portfolio/5. Github projects/ISM/First-example/soap.txt", header = TRUE)

head(soap.data, 5)  # Display first 5 lines of soap.data
# Add factor variable fSoap to soap.data frame for later ANOVA
soap.data$fSoap = factor(soap.data$Soap)


design$trtmt
trtmt
design[, 1]
design[, "trtmt"]
```

We could use `trtmt = rep(c(1, 2), each = 3)` to produce 6 treatments, 3 times each.



# Plot WtLoss vs Soap, specify axis labels, suppress x-axis.
plot(WtLoss ~ Soap, data=soap.data, 
     ylab = "Weight Loss (grams)", las=1, xaxt = "n")
# Insert x-axis (axis 1) with tick marks from 1 to 3 by 1.
axis(1, at = seq(1, 3, 1)) 

# Table 3.11, p63
summary(soap.data[,c(1,5:6)]) # Summarize data in cols 1, 5, 6
model1 = aov(WtLoss ~ fSoap, data=soap.data)
anova(model1)
# install.packages("lsmeans")
library(lsmeans)
lsmeans(model1, "fSoap")